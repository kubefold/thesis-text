%! suppress = MissingLabel
\chapter{Results}
%
%\section{Implementation of the KubeFold Project}
%
%Within the project, the following goals were successfully accomplished:
%\begin{itemize}
%    \item Designed and implemented the \textit{KubeFold} operator for the Kubernetes platform.
%    \item Created two custom resources (CRDs):
%    \begin{itemize}
%        \item \textit{ProteinDatabase} – managing protein databases,
%        \item \textit{ProteinConformationPrediction} – running protein conformation prediction computations.
%    \end{itemize}
%    \item Developed a component for automatic downloading and decompression of protein databases.
%    \item Prepared infrastructure as code (IaC) allowing for quick operator deployment in AWS cloud (EKS + FSx for Lustre).
%    \item Created documentation and installation instructions for the Kubernetes operator.
%    \item Conducted several protein conformation computations to test the solution.
%\end{itemize}


\section{Comparison of manual and automated AlphaFold installation}

To fully understand the advantages of the KubeFold operator, it is essential to compare the time and effort required for manual installation versus automated deployment using Kubernetes.

\subsection{Time requirements for manual AlphaFold setup}

Manual installation of AlphaFold on an EC2 Ubuntu instance requires significant time investment across several stages:

\begin{enumerate}
    \item \textbf{Infrastructure setup} (30-60 minutes):
    \begin{itemize}
        \item Launching an appropriate EC2 instance (typically p3.2xlarge with NVIDIA GPU)
        \item Configuring and attaching storage volumes (minimum 3TB)
        \item Setting up network access and security groups
    \end{itemize}
    
    \item \textbf{Environment configuration} (30-60 minutes):
    \begin{itemize}
        \item Installing NVIDIA drivers and CUDA toolkit
        \item Setting up Docker and NVIDIA Container Toolkit
        \item Configuring appropriate permissions and environment variables
    \end{itemize}
    
    \item \textbf{Protein database acquisition} (70 minutes):
    \begin{itemize}
        \item Downloading multiple large databases (BFD, MGnify, PDB70, PDB mmCIF, UniRef30, UniProt, UniRef90)
        \item Total download size approximately 415GB (2.62TB after extraction)
    \end{itemize}
    
    \item \textbf{Software configuration} (60-180 minutes):
    \begin{itemize}
        \item Building the AlphaFold Docker image
        \item Troubleshooting CUDA library compatibility issues
        \item Testing GPU detection and functionality
        \item Configuring input and output paths
    \end{itemize}
    
    \item \textbf{Protein structure prediction} (25 minutes):
    \begin{itemize}
        \item Running the actual prediction process
        \item Managing computational resources
    \end{itemize}
\end{enumerate}

The total time required for manual setup ranges from 3-5 hours, excluding any troubleshooting that might be necessary. Most critically, this process requires continuous user interaction and technical expertise in Linux system administration, GPU configuration, and containerization.

\subsection{KubeFold automated deployment process}

In contrast, the KubeFold operator streamlines this entire process into a few simple steps:

\begin{enumerate}
    \item \textbf{Cluster creation} (50 minutes):
    \begin{itemize}
        \item Setting up a Kubernetes cluster in AWS (EKS)
        \item This process is automated through infrastructure as code
        \item Requires minimal user interaction
    \end{itemize}
    
    \item \textbf{Operator installation} (5 minutes):
    \begin{itemize}
        \item Deploying the KubeFold operator to the cluster
        \item Setting up necessary permissions and service accounts
    \end{itemize}
    
    \item \textbf{Protein database acquisition} (70 minutes):
    \begin{itemize}
        \item Creating a \texttt{ProteinDatabase} custom resource
        \item Automated downloading and processing of all required databases
        \item Parallel downloading for optimal performance
    \end{itemize}
    
    \item \textbf{Protein structure prediction} (25 minutes):
    \begin{itemize}
        \item Creating a \texttt{ProteinConformationPrediction} custom resource
        \item Automated execution of the prediction process
        \item Results storage and notification
    \end{itemize}
\end{enumerate}

The total time for the KubeFold approach is approximately 150 minutes (2.5 hours), with the significant advantage that the entire process requires virtually no user intervention beyond the initial resource creation. The operator handles all complex tasks automatically, including resource provisioning, job scheduling, and result management.

\subsection{Comparative analysis}

Table~\ref{tab:installation_comparison} presents a direct comparison between manual and KubeFold-based AlphaFold installation approaches:

\begin{table}[H]
    \centering
    \small
    \begin{tabularx}{\textwidth}{|X|X|X|}
        \hline
        \textbf{Aspect} & \textbf{Manual Installation} & \textbf{KubeFold Approach} \\
        \hline
        \textbf{Total setup time} & 3-5 hours & 2.5 hours \\
        \hline
        \textbf{Required user interaction} & Continuous involvement throughout the process & Minimal (only initial resource creation) \\
        \hline
        \textbf{Technical expertise required} & High (Linux, Docker, CUDA, GPU configuration) & Basic Kubernetes knowledge only \\
        \hline
        \textbf{Error susceptibility} & High (many manual steps) & Low (automated processes) \\
        \hline
        \textbf{Scalability} & Limited to single machine & Highly scalable across cluster nodes \\
        \hline
        \textbf{Resource optimization} & Manual management & Automatic allocation and cleanup \\
        \hline
        \textbf{Reproducibility} & Challenging (environment variations) & Consistent (declarative approach) \\
        \hline
    \end{tabularx}
    \caption{Comparison of manual and KubeFold-based AlphaFold installation}
    \label{tab:installation_comparison}
\end{table}

\subsection{Key advantages of the KubeFold approach}

The KubeFold operator provides several significant advantages over manual installation:

\begin{itemize}
    \item \textbf{Zero interaction requirement:} After initial resource creation, the entire process runs without user intervention, freeing researchers to focus on scientific work rather than infrastructure management.
    
    \item \textbf{Error reduction:} By automating complex setup procedures, KubeFold eliminates common errors in environment configuration and dependency management.
    
    \item \textbf{Resource optimization:} The operator intelligently allocates computational resources, separating CPU-intensive alignment tasks from GPU-intensive prediction tasks to optimize cost and performance.
    
    \item \textbf{Scalability:} Multiple predictions can be run in parallel across cluster nodes, significantly increasing throughput for large-scale studies.
    
    \item \textbf{Reproducibility:} The declarative, Kubernetes-based approach ensures consistent environments and results across different executions.
    
    \item \textbf{Integration with cloud services:} Native integration with AWS services like S3, FSx for Lustre, and SNS provides robust storage, high-performance file systems, and automated notifications.
\end{itemize}

These advantages make KubeFold particularly valuable for research teams that need to run multiple protein structure predictions without dedicating significant time and expertise to infrastructure management. The platform effectively bridges the gap between the computational complexity of AlphaFold and the practical needs of biological researchers.

\section{Comparison of alternative solutions}

The AlphaFold algorithm has significantly influenced the development of bioinformatics, offering breakthrough capabilities in predicting protein spatial structures.
However, its practical use comes with significant computational and technological requirements.
In response to these challenges, alternative solutions have emerged, such as \textbf{OpenFold}\cite{openfold} and \textbf{ColabFold}\cite{colabfold}, which aimed to simplify the prediction process and increase its accessibility.
However, \textbf{KubeFold} – the system developed as part of this work – stands out among these tools, providing a much higher level of automation, scalability, and cloud infrastructure integration.

\subsection*{OpenFold}

OpenFold is an open--source reimplementation of AlphaFold2, written in Python using the PyTorch library.
This project is primarily targeted at research teams and institutions that have extensive computational infrastructure and need full control over the prediction process.
OpenFold enables, among other things, training models from scratch, testing architecture modifications, and running tasks in distributed environments (HPC, cloud).

Due to the advanced nature of the tool, its implementation requires high expertise in machine learning, container management, and cloud environment configuration.
Significant hardware resources (e.g., A100--class GPU cards) are also necessary, which may be an entry barrier for smaller teams.

\subsection*{ColabFold}

ColabFold is a simplified version of AlphaFold2, available through interactive notebooks running in the Google Colaboratory environment.
Thanks to integration with the MMseqs2 tool, the sequence alignment process is much faster, and users don't need to configure the environment or install software themselves.

ColabFold is primarily aimed at individuals and teams that don't have advanced computational infrastructure.
Despite the low entry threshold, this solution has numerous limitations: it doesn't allow model training, is dependent on Colab platform limitations (session time, GPU availability), and its application is mainly limited to simple, single predictive tasks.

\subsection*{Advantages of the KubeFold Approach}

The \textbf{KubeFold} platform developed as part of this work represents a modern and flexible alternative to the above solutions.
By utilizing Kubernetes technology and integration with Amazon Web Services (such as FSx for Lustre and S3), KubeFold automates the entire process of running protein conformation predictions – from downloading databases, through running calculations, to archiving results and sending notifications.

Unlike OpenFold, KubeFold doesn't require manual task configuration or infrastructure management – all components are automatically launched based on YAML resources, which significantly simplifies the process.
Compared to ColabFold, the KubeFold platform offers much greater scalability and control over computational resources – allowing for simultaneous running of multiple tasks and allocating appropriate resources (CPU, GPU, memory, disk space).
%TODO(matisiekpl): I don't know if this is enough
This scalability is achieved due to being built on top of Kubernetes platform.

This approach combines the advantages of flexibility and computational power with ease of use, making KubeFold a more comprehensive solution adapted to the real needs of research environments and production applications.

A detailed comparison of the computational infrastructure for OpenFold, ColabFold, and KubeFold is presented in Table~\ref{tab:comparison}.

\begin{table}[H]
    \centering
    \small
    \begin{tabularx}{\textwidth}{|X|X|X|X|}
        \hline
        \textbf{Features}                           & \textbf{OpenFold}                         & \textbf{ColabFold}                & \textbf{KubeFold (proposed)}                          \\
        \hline
        \textbf{Platform}                           & HPC clusters, cloud (AWS, GCP)            & Google Colab, local environments & Kubernetes + AWS EKS \\
        \hline
        \textbf{Hardware requirements}              & High (GPU A100, RAM 64GB+)                & Low (free GPU in Colab) & Medium--high, dynamically scalable \\
        \hline
        \textbf{Automation}                         & Manual task and environment configuration & None, manual handling by user & Full automation through Kubernetes operator \\
        \hline
        \textbf{Scalability}                        & High, but difficult to configure          & Limited to single predictions & Very high, supports parallel processing \\
        \hline
        \textbf{Ease of deployment}                 & High entry threshold (DevOps, ML)         & Very easy, suitable for beginners & Medium threshold, requires basic Kubernetes knowledge \\
        \hline
        \textbf{Integration with external services} & Requires own implementation               & None                              & Yes – AWS S3, FSx, SNS, IAM                           \\
        \hline
    \end{tabularx}
    \caption{Comparison of computational infrastructure: OpenFold, ColabFold, and KubeFold}
    \label{tab:comparison}
\end{table}

\section{Challenges}

The main challenge was developing an appropriate architecture for the KubeFold platform that can operate on multiple cluster nodes simultaneously, optimizing costs and computation speed.
By dividing the download process into multiple pods, it was possible to increase the potential throughput of protein database downloads.
Additionally, separating the \textit{Aligning} and \textit{Predicting} phases allowed for optimal utilization of CPU and GPU computational resources.
This setup enables cost savings in the public cloud.

The second challenge was the proper implementation of the \textit{downloader} component.
This component must simultaneously download and decompress data.
If this process were to occur sequentially, the temporarily used disk space would be much larger than the actual size of the database.

The third challenge was setting up appropriate infrastructure for testing the KubeFold platform.
The project runs using multiple AWS cloud services, which requires thoughtful integration of each component.
Setting up appropriate subnet configurations, VPC, and CSI drivers required a significant amount of time.

\section{Conclusions}

The KubeFold project successfully addresses the challenges of protein structure prediction by leveraging modern cloud technologies and Kubernetes orchestration.
The implementation demonstrates that complex scientific computations can be effectively managed through a declarative, operator--based approach, significantly reducing operational overhead.
The platform's architecture, combining AWS services like FSx for Lustre and S3 with Kubernetes orchestration, provides a scalable and cost--effective solution for running AlphaFold predictions.
The separation of database management and computation phases, along with automated resource provisioning and cleanup, makes the system particularly suitable for research environments requiring high--throughput protein structure predictions.
This work demonstrates how cloud--native technologies can transform complex scientific workflows into manageable, automated processes, potentially accelerating discoveries in structural biology and drug development.